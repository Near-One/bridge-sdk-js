---
title: Fee Calculation
description: Calculate transaction fees for Bitcoin and Zcash
---

The SDK provides fee calculators for Bitcoin and Zcash transactions.

## Bitcoin: Linear Fee Calculator

Bitcoin uses a linear fee model based on transaction size.

### Import

```typescript
import { linearFeeCalculator } from "@omni-bridge/btc"
```

### Signature

```typescript
function linearFeeCalculator(params: LinearFeeParameters): FeeCalculator

type FeeCalculator = (inputs: number, outputs: number) => bigint
```

### Parameters

```typescript
interface LinearFeeParameters {
  base: number    // Base transaction size in vbytes
  input: number   // Size per input (typically 68)
  output: number  // Size per output (typically 31)
  rate: number    // Fee rate in sat/vbyte
}
```

### Example

```typescript
import { linearFeeCalculator } from "@omni-bridge/btc"

const calculator = linearFeeCalculator({
  base: 10,
  input: 68,
  output: 31,
  rate: 15,  // 15 sat/vbyte
})

// Calculate fee for 2 inputs, 2 outputs
const fee = calculator(2, 2)
// (10 + 2*68 + 2*31) * 15 = 3120 satoshis
```

## Zcash: ZIP-317 Fee Calculator

Zcash uses the ZIP-317 marginal fee structure.

### Import

```typescript
import { zcashFeeCalculator, calculateZcashFee, ZCASH_DUST_THRESHOLD } from "@omni-bridge/btc"
```

### Functions

```typescript
// Get a fee calculator function
function zcashFeeCalculator(): FeeCalculator

// Calculate fee directly
function calculateZcashFee(inputs: number, outputs: number): bigint
```

### Example

```typescript
import { zcashFeeCalculator, calculateZcashFee } from "@omni-bridge/btc"

// Using calculator function
const calculator = zcashFeeCalculator()
const fee = calculator(2, 2)

// Or calculate directly
const fee2 = calculateZcashFee(2, 2)
```

## Zcash Script Utility

```typescript
import { getZcashScript } from "@omni-bridge/btc"

const script = getZcashScript("t1YourZcashAddress...")
```

## Usage with UTXO Selection

```typescript
import { createBtcBuilder, linearFeeCalculator } from "@omni-bridge/btc"

const btc = createBtcBuilder({ network: "mainnet", chain: "btc" })

// Select UTXOs with specific fee rate
const selected = btc.selectUtxos(utxos, amount, {
  feeRate: 15,  // sat/vbyte
})

console.log(`Estimated fee: ${selected.fee} satoshis`)
```

## Fee Rate Estimation

The SDK doesn't include fee rate estimation. Get current rates from:
- [mempool.space/api](https://mempool.space/api/v1/fees/recommended)
- Your Bitcoin node's `estimatesmartfee` RPC

```typescript
// Example: fetch fee rate from mempool.space
const response = await fetch("https://mempool.space/api/v1/fees/recommended")
const fees = await response.json()

const feeRate = fees.halfHourFee  // sat/vbyte for ~30 min confirmation

const selected = btc.selectUtxos(utxos, amount, { feeRate })
```

## Constants

```typescript
// Zcash dust threshold
const ZCASH_DUST_THRESHOLD = 5000n  // zatoshis

// Bitcoin dust (standard)
const BTC_DUST = 546n  // satoshis
```

## Related

- [UTXO Selection](/reference/btc/utxo-selection)
- [createBtcBuilder](/reference/btc/create-builder)
- [Bitcoin Transfers Guide](/guides/bitcoin-transfers)
