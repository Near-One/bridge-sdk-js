---
title: NEAR → ETH Transfer
description: Complete example of bridging tokens from NEAR to Ethereum
---

# NEAR to ETH Transfer

This example demonstrates bridging tokens from NEAR Protocol to Ethereum, including storage deposit handling and using the shim functions.

## Overview

<Steps>
  <Step title="Setup">
    Initialize the bridge and NEAR builder.
  </Step>
  <Step title="Storage Deposit">
    Ensure the sender has sufficient storage deposit on the bridge contract.
  </Step>
  <Step title="Validate">
    Validate the transfer parameters.
  </Step>
  <Step title="Transfer">
    Build and send the `ft_transfer_call` transaction.
  </Step>
  <Step title="Track">
    Monitor until finalized on Ethereum.
  </Step>
</Steps>

## Complete Example

<CodeGroup>

```typescript near-kit
import { createBridge, ChainKind, BridgeAPI } from "@omni-bridge/core"
import { createNearBuilder, toNearKitTransaction } from "@omni-bridge/near"
import { Near } from "near-kit"

// Configuration
const WRAPPED_USDC = "near:usdc.bridge.near" // Bridged USDC on NEAR
const SENDER = "near:alice.near"
const RECIPIENT = "eth:0xYourEthAddress..."

async function bridgeNearToEth() {
  // 1. Initialize
  const bridge = createBridge({ network: "mainnet" })
  const nearBuilder = createNearBuilder({ network: "mainnet" })
  const api = new BridgeAPI("mainnet")

  const near = new Near({
    network: "mainnet",
    privateKey: "ed25519:...",
    defaultSignerId: "alice.near",
  })

  const signerId = "alice.near"

  // 2. Check and handle storage deposit
  const requiredDeposit = await nearBuilder.getRequiredStorageDeposit(signerId)

  if (requiredDeposit > 0n) {
    console.log(`Storage deposit needed: ${requiredDeposit} yoctoNEAR`)

    const storageTx = nearBuilder.buildStorageDeposit(signerId, requiredDeposit)
    const storageResult = await toNearKitTransaction(near, storageTx).send()
    console.log("Storage deposit confirmed:", storageResult.transaction.hash)
  }

  // 3. Validate transfer
  const validated = await bridge.validateTransfer({
    token: WRAPPED_USDC,
    amount: 100_000_000n, // 100 USDC (6 decimals)
    fee: 0n,
    nativeFee: 0n,
    sender: SENDER,
    recipient: RECIPIENT,
  })

  console.log("Validated transfer:", {
    normalizedAmount: validated.normalizedAmount,
    sourceChain: ChainKind[validated.sourceChain],
    destChain: ChainKind[validated.destChain],
  })

  // 4. Build and send transfer
  const transferTx = nearBuilder.buildTransfer(validated, signerId)

  const result = await toNearKitTransaction(near, transferTx).send({
    waitUntil: "FINAL",
  })

  console.log("Transfer sent:", result.transaction.hash)
  console.log("Explorer:", `https://nearblocks.io/txns/${result.transaction.hash}`)

  // 5. Track transfer status
  console.log("Waiting for finalization on Ethereum...")

  for (let i = 0; i < 60; i++) {
    const transfers = await api.getTransfer({
      transactionHash: result.transaction.hash,
    })
    const transfer = transfers[0]

    if (transfer?.finalized) {
      console.log("Transfer finalized on Ethereum!")
      console.log("  ETH TX:", transfer.destination?.transactionHash)
      return transfer
    }

    console.log(`  Status: ${transfer?.status ?? "pending"}...`)
    await new Promise((r) => setTimeout(r, 15000))
  }
}

bridgeNearToEth().catch(console.error)
```

```typescript near-api-js
import { createBridge, ChainKind, BridgeAPI } from "@omni-bridge/core"
import { createNearBuilder, sendWithNearApiJs } from "@omni-bridge/near"
import { connect, keyStores, KeyPair } from "near-api-js"

// Configuration
const WRAPPED_USDC = "near:usdc.bridge.near"
const SENDER = "near:alice.near"
const RECIPIENT = "eth:0xYourEthAddress..."

async function bridgeNearToEth() {
  // 1. Initialize
  const bridge = createBridge({ network: "mainnet" })
  const nearBuilder = createNearBuilder({ network: "mainnet" })
  const api = new BridgeAPI("mainnet")

  // Setup near-api-js
  const keyStore = new keyStores.InMemoryKeyStore()
  await keyStore.setKey(
    "mainnet",
    "alice.near",
    KeyPair.fromString("ed25519:...")
  )

  const nearConnection = await connect({
    networkId: "mainnet",
    keyStore,
    nodeUrl: "https://rpc.mainnet.near.org",
  })

  const account = await nearConnection.account("alice.near")
  const signerId = "alice.near"

  // 2. Check and handle storage deposit
  const requiredDeposit = await nearBuilder.getRequiredStorageDeposit(signerId)

  if (requiredDeposit > 0n) {
    console.log(`Storage deposit needed: ${requiredDeposit} yoctoNEAR`)

    const storageTx = nearBuilder.buildStorageDeposit(signerId, requiredDeposit)
    await sendWithNearApiJs(account, storageTx)
    console.log("Storage deposit confirmed")
  }

  // 3. Validate transfer
  const validated = await bridge.validateTransfer({
    token: WRAPPED_USDC,
    amount: 100_000_000n, // 100 USDC
    fee: 0n,
    nativeFee: 0n,
    sender: SENDER,
    recipient: RECIPIENT,
  })

  // 4. Build and send transfer
  const transferTx = nearBuilder.buildTransfer(validated, signerId)

  const result = await sendWithNearApiJs(account, transferTx)
  console.log("Transfer sent:", result.transaction.hash)

  // 5. Track transfer status
  console.log("Waiting for finalization on Ethereum...")

  for (let i = 0; i < 60; i++) {
    const transfers = await api.getTransfer({
      transactionHash: result.transaction.hash,
    })
    const transfer = transfers[0]

    if (transfer?.finalized) {
      console.log("Transfer finalized on Ethereum!")
      return transfer
    }

    await new Promise((r) => setTimeout(r, 15000))
  }
}

bridgeNearToEth().catch(console.error)
```

</CodeGroup>

## Storage Deposits

<Warning>
**Storage Required**: NEAR requires storage deposits for new accounts on contracts. Always check `getRequiredStorageDeposit()` before first-time transfers.
</Warning>

The bridge contract requires storage for:
- Account registration
- Transfer state tracking

```typescript
// Check if storage deposit is needed
const required = await nearBuilder.getRequiredStorageDeposit(signerId)

if (required > 0n) {
  // Typically ~0.00125 NEAR for first-time users
  const storageTx = nearBuilder.buildStorageDeposit(signerId, required)
  await toNearKitTransaction(near, storageTx).send()
}
```

## Token Storage

For NEP-141 tokens, the bridge contract also needs storage registration on the token contract:

```typescript
// Check if bridge has storage on the token
const hasStorage = await nearBuilder.isTokenStorageRegistered("usdc.bridge.near")

if (!hasStorage) {
  const tokenStorageTx = await nearBuilder.buildTokenStorageDeposit(
    "usdc.bridge.near",
    signerId
  )
  await toNearKitTransaction(near, tokenStorageTx).send()
}
```

## Shim Functions

The SDK provides shim functions to convert `NearUnsignedTransaction` to library-specific formats:

| Function | Library | Description |
|----------|---------|-------------|
| `toNearKitTransaction()` | near-kit | Returns a TransactionBuilder for chaining |
| `toNearApiJsActions()` | near-api-js | Converts to Action[] for signAndSendTransaction |
| `sendWithNearApiJs()` | near-api-js | One-liner to convert and send |

```typescript
import {
  toNearKitTransaction,
  toNearApiJsActions,
  sendWithNearApiJs,
} from "@omni-bridge/near"

// near-kit: chainable API
await toNearKitTransaction(near, tx).send({ waitUntil: "FINAL" })

// near-api-js: get actions for manual handling
const actions = toNearApiJsActions(tx)
await account.signAndSendTransaction({
  receiverId: tx.receiverId,
  actions,
})

// near-api-js: convenience wrapper
await sendWithNearApiJs(account, tx)
```

## Native NEAR Tokens

When bridging NEAR-native tokens (not wrapped tokens from other chains):

```typescript
// Bridge native NEAR token to Ethereum
const validated = await bridge.validateTransfer({
  token: "near:wrap.near", // wNEAR token
  amount: 1_000_000_000_000_000_000_000_000n, // 1 NEAR (24 decimals)
  fee: 0n,
  nativeFee: 0n,
  sender: "near:alice.near",
  recipient: "eth:0x...",
})

// The SDK looks up the bridged token address on Ethereum automatically
console.log("Bridged token on ETH:", validated.bridgedToken)
// → "eth:0x..." (wrapped NEAR on Ethereum)
```

## Finalization Timeline

NEAR → EVM transfers typically finalize in:

| Stage | Time |
|-------|------|
| NEAR confirmation | ~1-2 seconds |
| Wormhole attestation | ~15-30 seconds |
| MPC signature | ~1-5 minutes |
| EVM finalization | ~2-15 minutes |

Total: **~5-20 minutes** depending on network conditions.

## Error Handling

```typescript
try {
  const result = await toNearKitTransaction(near, transferTx).send()
} catch (error) {
  if (error.message.includes("insufficient storage")) {
    // Need to deposit storage first
    const storageTx = nearBuilder.buildStorageDeposit(signerId, required)
    await toNearKitTransaction(near, storageTx).send()
    // Retry transfer
  } else if (error.message.includes("insufficient balance")) {
    console.error("Not enough token balance")
  } else {
    throw error
  }
}
```

## Next Steps

<CardGroup cols={2}>
  <Card title="ETH → NEAR" icon="arrow-left" href="/examples/eth-to-near">
    Bridge tokens from Ethereum to NEAR
  </Card>
  <Card title="Storage Deposits" icon="database" href="/reference/near/storage-deposits">
    Deep dive into NEAR storage requirements
  </Card>
</CardGroup>
